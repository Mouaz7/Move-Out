<%- include("../partials/header") %>

<div class="login-container">
  <div class="login-box">
    <h2 class="login-title">
      <i class="fas fa-sign-in-alt"></i>
      <span data-i18n="loginTitle">Login to MoveOut</span>
    </h2>

    <form action="/move/login" method="POST">
      <input type="hidden" name="_csrf" value="<%= csrfToken %>" />
      <div class="input-container">
        <label for="email"
          ><i class="fas fa-envelope"></i>
          <span data-i18n="email">Email</span></label
        >
        <input
          type="email"
          id="email"
          name="email"
          data-i18n-placeholder="enterEmail"
          placeholder="Enter your email"
          required
        />
      </div>

      <div class="input-container">
        <label for="psw"
          ><i class="fas fa-lock"></i>
          <span data-i18n="password">Password</span></label
        >
        <input
          type="password"
          id="psw"
          name="psw"
          data-i18n-placeholder="enterPassword"
          placeholder="Enter your password"
          required
        />
      </div>

      <% if (errorMessage) { %>
      <div class="error-message" id="error-message">
        <p><i class="fas fa-exclamation-triangle"></i> <%= errorMessage %></p>
      </div>
      <% } %>

      <button type="submit" class="btn login-btn" id="submit-button">
        <i class="fas fa-arrow-right"></i>
        <span data-i18n="loginBtn">Login</span>
      </button>

      <div class="forgot-password" id="forgot-password">
        <a href="/move/forgot-password"
          ><i class="fas fa-key"></i>
          <span data-i18n="forgotPassword">Forgot password?</span></a
        >
      </div>

      <div class="register-link" id="register-link">
        <p>
          <span data-i18n="noAccount">Don't have an account?</span>
          <a href="/move/register"
            ><i class="fas fa-user-plus"></i>
            <span data-i18n="signUp">Sign Up</span></a
          >
        </p>
      </div>
    </form>

    <!-- Google Login Button -->
    <div class="google-login" id="google-login">
      <a href="/auth/google" class="btn google-btn">
        <img src="/style/google.ico" alt="Google Icon" class="google-icon" />
        <span data-i18n="loginWithGoogle">Login with Google</span>
      </a>
    </div>
  </div>
</div>

<script nonce="<%= cspNonce %>">
  document.addEventListener("DOMContentLoaded", () => {
    const errorMessage = document.getElementById("error-message");
    const submitButton = document.getElementById("submit-button");
    const forgotPassword = document.getElementById("forgot-password");
    const googleLogin = document.getElementById("google-login");
    const registerLink = document.getElementById("register-link");

    if (errorMessage) {
      submitButton.style.display = "none";
      forgotPassword.style.display = "none";
      googleLogin.style.display = "none";
      registerLink.style.display = "none";
      errorMessage.style.display = "block";
      setTimeout(() => {
        errorMessage.style.display = "none";
        submitButton.style.display = "block";
        forgotPassword.style.display = "block";
        googleLogin.style.display = "block";
        registerLink.style.display = "block";
      }, 4000);
    }
  });
</script>

<%- include("../partials/footer") %>
